<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>MapInfo Blog</title>
  
  <subtitle>Walter Whiteの博客空间</subtitle>
  <link href="https://mrwhitebare.github.io/atom.xml" rel="self"/>
  
  <link href="https://mrwhitebare.github.io/"/>
  <updated>2020-09-26T12:43:10.032Z</updated>
  <id>https://mrwhitebare.github.io/</id>
  
  <author>
    <name>Mr Heisenberg</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>C# using关键字用法</title>
    <link href="https://mrwhitebare.github.io/2020/0926undefined.html"/>
    <id>https://mrwhitebare.github.io/2020/0926undefined.html</id>
    <published>2020-09-26T08:50:30.000Z</published>
    <updated>2020-09-26T12:43:10.032Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-using关键字的用法"><a href="#1-using关键字的用法" class="headerlink" title="1.using关键字的用法"></a>1.using关键字的用法</h2><h3 id="1-1-引用命名空间"><a href="#1-1-引用命名空间" class="headerlink" title="1.1 引用命名空间"></a>1.1 引用命名空间</h3><p>&emsp;&emsp;应用名称空间<strong>namespace</strong>，可以引用我们需要的程序集，然后在程序中我们就不必再写详细的名称空间类型。</p><pre class="line-numbers language-C#" data-language="C#"><code class="language-C#">using system;using System.Data.OleDb;using System.Data;using System.Configuration;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>&emsp;&emsp;引用命名空间，并不等于编译器编译时加载该命名空间所在的程序集，程序集的加载决定于程序中对该程序集是否存在调用操作，如果代码中不存在任何调用操作则编译器将不会加载using引入命名空间所在空间的程序集。因此，在源文件开头，引入多个命名空间，并非加载多个程序集，不会造成“过度引用“的弊端。</p><h3 id="1-2-为命名空间或者类型创建别名"><a href="#1-2-为命名空间或者类型创建别名" class="headerlink" title="1.2 为命名空间或者类型创建别名"></a>1.2 为命名空间或者类型创建别名</h3><p>&emsp;&emsp;类似于<strong>Python</strong>关键字as,<strong>Pyhton</strong>的写法为：</p><blockquote><p>import turtle as t;</p></blockquote><p>而C# <strong>using</strong>关键字也可以做到简化名称，放便调用。</p><pre class="line-numbers language-C#" data-language="C#"><code class="language-C#">using ole&#x3D; System.Data.OleDb;using data&#x3D;System.Data;using con&#x3D;System.Configuration;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="1-3-using释放当前调用的资源"><a href="#1-3-using释放当前调用的资源" class="headerlink" title="1.3 using释放当前调用的资源"></a>1.3 using释放当前调用的资源</h3><p>&emsp;&emsp;<strong>using</strong>语句允许程序员指定使用资源的应当合适释放，using语句中使用对象必须实现<strong>IDisponsable</strong>接口，此方法释放对象的资源。</p><p>&emsp;&emsp; 在程序编译阶段，编译器会自动将using语句生成try-finally语句，并在finally块中调用对象的Dispose方法，来清理资源.所以，using语句等效于try-finally语句。<a href="https://www.cnblogs.com/zengdingding/p/5112578.html">部分内容引用于博客园博主zdick</a></p><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">&#x2F;*使用using语句*&#x2F;public static int CommandSQL(string SQL)&#123;&#x2F;&#x2F;建立连接   using (OleDbConnection objConnection &#x3D; new OleDbConnection(ConnectionString))   &#123;&#x2F;&#x2F;打开连接   objConnection.Open();   using (OleDbCommand cmd&#x3D;new OleDbCommand())   &#123;&#x2F;&#x2F;执行增删改查命令   cmd.Connection&#x3D;objConnection;   cmd.CommandText&#x3D;SQL;   int count&#x3D;cmd.ExecuteNonQuery();   &#x2F;*OleDbCommand.ExecuteNonQuery();   * 对于 UPDATE、INSERT 和 DELETE 语句，返回值为该命令所影响的行数。*  对于其他所有类型的语句，返回值为 -1。   *&#x2F;                &#x2F;&#x2F;返回执行结果    return count;         &#125;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-使用Data-Ole程序集连接Access数据库"><a href="#2-使用Data-Ole程序集连接Access数据库" class="headerlink" title="2. 使用Data.Ole程序集连接Access数据库"></a>2. 使用<strong>Data.Ole</strong>程序集连接Access数据库</h2><h3 id="2-1-创建共享文件夹"><a href="#2-1-创建共享文件夹" class="headerlink" title="2.1 创建共享文件夹"></a>2.1 创建共享文件夹</h3><h4 id="（1）打开cmd-命令窗口输入：ipconfig，并复制自己的IP地址。"><a href="#（1）打开cmd-命令窗口输入：ipconfig，并复制自己的IP地址。" class="headerlink" title="（1）打开cmd 命令窗口输入：ipconfig，并复制自己的IP地址。"></a>（1）打开cmd 命令窗口输入：ipconfig，并复制自己的IP地址。</h4><p><img src="https://gitee.com/mrwhitebare/blogpic/raw/master/blogpic/cmd.png" alt="查看自己的ip地址"></p><h4 id="（2）右键将要共享的文件夹的属性，设置共享文件夹加入自己的ip-文件名即可完成配置-【注意斜杆】。"><a href="#（2）右键将要共享的文件夹的属性，设置共享文件夹加入自己的ip-文件名即可完成配置-【注意斜杆】。" class="headerlink" title="（2）右键将要共享的文件夹的属性，设置共享文件夹加入自己的ip/文件名即可完成配置 【注意斜杆】。"></a>（2）右键将要共享的文件夹的属性，设置共享文件夹加入自己的ip/文件名即可完成配置 【注意斜杆】。</h4><p><img src="https://gitee.com/mrwhitebare/blogpic/raw/master/blogpic/ip.png" alt="共享文件夹设置"></p><h3 id="2-2-OleDb程序集介绍"><a href="#2-2-OleDb程序集介绍" class="headerlink" title="2.2 OleDb程序集介绍"></a>2.2 OleDb程序集介绍</h3><p>&emsp;&emsp;<a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1">System.Data.OleDb</a> 命名空间为 OLE DB .NET Framework数据提供程序。</p><table><thead><tr><th><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbcommand?view=dotnet-plat-ext-3.1">OleDbCommand</a></th><th align="left">表示要对数据源执行的 SQL 语句或存储过程。</th></tr></thead><tbody><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbcommandbuilder?view=dotnet-plat-ext-3.1">OleDbCommandBuilder</a></td><td align="left">自动生成用于协调对 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.dataset?view=dotnet-plat-ext-3.1">DataSet</a> 的更改与关联数据库的单表命令。 此类不能被继承。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbconnection?view=dotnet-plat-ext-3.1">OleDbConnection</a></td><td align="left">表示到数据源的连接是打开的。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbconnectionstringbuilder?view=dotnet-plat-ext-3.1">OleDbConnectionStringBuilder</a></td><td align="left">为创建和管理由 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbconnection?view=dotnet-plat-ext-3.1">OleDbConnection</a> 类使用的连接字符串的内容提供了一种简单方法。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbdataadapter?view=dotnet-plat-ext-3.1">OleDbDataAdapter</a></td><td align="left">表示用于填充 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.dataset?view=dotnet-plat-ext-3.1">DataSet</a> 和更新数据源的一组数据命令和一个数据库连接。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbdatareader?view=dotnet-plat-ext-3.1">OleDbDataReader</a></td><td align="left">提供从数据源读取数据行的只进流的方法。 此类不能被继承。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbenumerator?view=dotnet-plat-ext-3.1">OleDbEnumerator</a></td><td align="left">提供用于枚举本地网络中所有可用 OLE DB 提供程序的机制。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledberror?view=dotnet-plat-ext-3.1">OleDbError</a></td><td align="left">收集与数据源返回的警告或错误有关的信息。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledberrorcollection?view=dotnet-plat-ext-3.1">OleDbErrorCollection</a></td><td align="left">收集 OLE DB .NET Framework 数据提供程序生成的所有错误。 此类不能被继承。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbexception?view=dotnet-plat-ext-3.1">OleDbException</a></td><td align="left">在基础提供程序返回 OLE DB 数据源的警告或错误时引发的异常。 此类不能被继承。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbfactory?view=dotnet-plat-ext-3.1">OleDbFactory</a></td><td align="left">表示一组方法，这些方法用于创建 OLEDB 提供程序实现数据源类的实例。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbinfomessageeventargs?view=dotnet-plat-ext-3.1">OleDbInfoMessageEventArgs</a></td><td align="left">为 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbconnection.infomessage?view=dotnet-plat-ext-3.1">InfoMessage</a> 事件提供数据。 此类不能被继承。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbmetadatacollectionnames?view=dotnet-plat-ext-3.1">OleDbMetaDataCollectionNames</a></td><td align="left">提供一个常数列表，该列表与 GetSchema 方法一起使用以检索元数据集合。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbmetadatacolumnnames?view=dotnet-plat-ext-3.1">OleDbMetaDataColumnNames</a></td><td align="left">提供静态值，这些值用于 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbmetadatacollectionnames?view=dotnet-plat-ext-3.1">OleDbMetaDataCollectionNames</a> 中包含的 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.datatable?view=dotnet-plat-ext-3.1">DataTable</a> 对象的列名称。 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.datatable?view=dotnet-plat-ext-3.1">DataTable</a> 由 GetSchema 方法创建。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbparameter?view=dotnet-plat-ext-3.1">OleDbParameter</a></td><td align="left">表示 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbcommand?view=dotnet-plat-ext-3.1">OleDbCommand</a> 的参数，还可以是参数到 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.dataset?view=dotnet-plat-ext-3.1">DataSet</a> 列的映射。 此类不能被继承。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbparametercollection?view=dotnet-plat-ext-3.1">OleDbParameterCollection</a></td><td align="left">表示与 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbcommand?view=dotnet-plat-ext-3.1">OleDbCommand</a> 相关的参数集合及其各自到 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.dataset?view=dotnet-plat-ext-3.1">DataSet</a> 中列的映射。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbpermission?view=dotnet-plat-ext-3.1">OleDbPermission</a></td><td align="left">启用用于 OLE DB 的 .NET Framework 数据提供程序，以帮助确保用户具有足够的安全级别来访问 OLE DB 数据源。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbpermissionattribute?view=dotnet-plat-ext-3.1">OleDbPermissionAttribute</a></td><td align="left">将某安全操作与自定义安全特性相关联。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbrowupdatedeventargs?view=dotnet-plat-ext-3.1">OleDbRowUpdatedEventArgs</a></td><td align="left">为 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbdataadapter.rowupdated?view=dotnet-plat-ext-3.1">RowUpdated</a> 事件提供数据。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbrowupdatingeventargs?view=dotnet-plat-ext-3.1">OleDbRowUpdatingEventArgs</a></td><td align="left">为 <a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbdataadapter.rowupdating?view=dotnet-plat-ext-3.1">RowUpdating</a> 事件提供数据。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbschemaguid?view=dotnet-plat-ext-3.1">OleDbSchemaGuid</a></td><td align="left">返回由 [GetOleDbSchemaTable(Guid, Object<a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbconnection.getoledbschematable?view=dotnet-plat-ext-3.1#System_Data_OleDb_OleDbConnection_GetOleDbSchemaTable_System_Guid_System_Object___">])</a> 方法指定的架构表类型。</td></tr><tr><td><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbtransaction?view=dotnet-plat-ext-3.1">OleDbTransaction</a></td><td align="left">表示要在数据源进行的 SQL 事务。 此类不能被继承。</td></tr></tbody></table><p>&emsp;&emsp;我们主要使用<a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbconnection?view=dotnet-plat-ext-3.1">OleDbConnection</a>类与<a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.data.oledb.oledbcommand?view=dotnet-plat-ext-3.1">OleDbCommand</a>类</p><h3 id="2-3-新建SQLHelper-cs类用来调用Access数据库"><a href="#2-3-新建SQLHelper-cs类用来调用Access数据库" class="headerlink" title="2.3 新建SQLHelper.cs类用来调用Access数据库"></a>2.3 新建SQLHelper.cs类用来调用Access数据库</h3><p>&emsp;&emsp;在SQLHelper.cs类中添加以下方法：</p><pre class="line-numbers language-C#" data-language="C#"><code class="language-C#">public static int CommandSQL(string SQL)&#123;  &#x2F;&#x2F;建立连接   using (OleDbConnection objConnection &#x3D; new OleDbConnection(ConnectionString))   &#123;&#x2F;&#x2F;打开连接      objConnection.Open();   using (OleDbCommand cmd&#x3D;new OleDbCommand())   &#123;&#x2F;&#x2F;执行增删改查命令       cmd.Connection&#x3D;objConnection;       cmd.CommandText&#x3D;SQL;       int count&#x3D;cmd.ExecuteNonQuery();   &#x2F;*OleDbCommand.ExecuteNonQuery();   * 对于 UPDATE、INSERT 和 DELETE 语句，返回值为该命令所影响的行数。   *  对于其他所有类型的语句，返回值为 -1。   *&#x2F;                &#x2F;&#x2F;返回执行结果       return count;         &#125;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-批量使用SQL语句定义Access中字段类型"><a href="#3-批量使用SQL语句定义Access中字段类型" class="headerlink" title="3. 批量使用SQL语句定义Access中字段类型"></a>3. 批量使用SQL语句定义Access中字段类型</h2><h3 id="3-1-SQL语句改变字段类型"><a href="#3-1-SQL语句改变字段类型" class="headerlink" title="3.1 SQL语句改变字段类型"></a>3.1 SQL语句改变字段类型</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 Byte <span class="token comment">//数字[字节]</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 Long <span class="token comment">//数字[长整型]</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 Short <span class="token comment">//数字[整型]</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 Single <span class="token comment">//数字[单精度</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 <span class="token keyword">Double</span> <span class="token comment">//数字[双精度]</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 Currency <span class="token comment">//货币</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 <span class="token keyword">Char</span> <span class="token comment">//文本</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 <span class="token keyword">Text</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment">//文本，其中n表示字段大小</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 <span class="token keyword">Binary</span> <span class="token comment">//二进制</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 Counter <span class="token comment">//自动编号</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 Memo <span class="token comment">//备注</span><span class="token keyword">Alter</span> <span class="token keyword">TABLE</span> 表名称 <span class="token keyword">Alter</span> <span class="token keyword">COLUMN</span> 字段名称 <span class="token keyword">Time</span> <span class="token comment">//日期/时间</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2-定义-DefineFields-方法"><a href="#3-2-定义-DefineFields-方法" class="headerlink" title="3.2 定义**DefineFields()**方法"></a>3.2 定义**DefineFields()**方法</h3><blockquote><p>需要自己定义的字段类型及长度</p></blockquote><pre class="line-numbers language-C#" data-language="C#"><code class="language-C#">JSYDSYQ&#x3D;new string[,]&#123;&#123;&quot;YSDM&quot;,&quot;TEXT&quot;,&quot;10&quot;&#125;,&#123;&quot;ZDDM&quot;,&quot;TEXT&quot;,&quot;19&quot;&#125;,&#123;&quot;BDCDYH&quot;,&quot;TEXT&quot;,&quot;28&quot;&#125;,&#123;&quot;YWH&quot;,&quot;TEXT&quot;,&quot;20&quot;&#125;,&#123;&quot;QLLX&quot;,&quot;TEXT&quot;,&quot;2&quot;&#125;,&#123;&quot;DJLX&quot;,&quot;TEXT&quot;,&quot;6&quot;&#125;,&#123;&quot;DJYY&quot;,&quot;TEXT&quot;,&quot;200&quot;&#125;,&#123;&quot;SYQMJ&quot;,&quot;double&quot;,&quot;2&quot;&#125;,&#123;&quot;SYQQSSJ&quot;,&quot;DateTime&quot;,&quot;0&quot;&#125;,&#123;&quot;SYQJSSJ&quot;,&quot;DateTime&quot;,&quot;0&quot;&#125;,&#123;&quot;QDJG&quot;,&quot;double&quot;,&quot;0&quot;&#125;,&#123;&quot;BDCQZH&quot;,&quot;TEXT&quot;,&quot;255&quot;&#125;,&#123;&quot;QXDM&quot;,&quot;TEXT&quot;,&quot;6&quot;&#125;,&#123;&quot;DJJG&quot;,&quot;TEXT&quot;,&quot;200&quot;&#125;,&#123;&quot;DBR&quot;,&quot;TEXT&quot;,&quot;50&quot;&#125;,&#123;&quot;DJSJ&quot;,&quot;DateTime&quot;,&quot;0&quot;&#125;,&#123;&quot;FJ&quot;,&quot;TEXT&quot;,&quot;255&quot;&#125;,&#123;&quot;QSZT&quot;,&quot;TEXT&quot;,&quot;2&quot;&#125;&#125;;&#x2F;&#x2F;多维数组<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">public static void DefineFields(string [,] array,string tableName)&#123;int i&#x3D;0;string sql&#x3D;&quot;&quot;;while(i &lt; array.GetLength(0))&#123;switch(array[i,1])&#123;case &quot;TEXT&quot;:sql&#x3D;String.Format(@&quot;Alter TABLE &#123;0&#125;  Alter COLUMN &#123;1&#125; Text(&#123;2&#125;)&quot;,tableName,array[i,0],array[i,2]);           int count&#x3D;SQLHelper.CommandSQL(sql);           if (count!&#x3D;-1)           Print(&quot;定义字段:&quot;+array[i,0]+&quot;成功；长度为：&quot;+array[i,2]);break;case &quot;DateTime&quot;:sql&#x3D;String.Format(@&quot;Alter TABLE &#123;0&#125;  Alter COLUMN &#123;1&#125; DateTime&quot;,tableName,array[i,0]);           int count1&#x3D;SQLHelper.CommandSQL(sql);           if (count1!&#x3D;-1)           Print(&quot;定义字段:&quot;+array[i,0]+&quot;成功；类型为：&quot;+array[i,1]);          break;case &quot;double&quot;:sql&#x3D;String.Format(@&quot;Alter TABLE &#123;0&#125;  Alter COLUMN &#123;1&#125; double&quot;,tableName,array[i,0]);           int count2&#x3D;SQLHelper.CommandSQL(sql);           if (count2!&#x3D;-1)           Print(&quot;定义字段:&quot;+array[i,0]+&quot;成功；类型为：&quot;+array[i,1]);break;default:sql&#x3D;String.Format(@&quot;Alter TABLE &#123;0&#125;  Alter COLUMN &#123;1&#125; long&quot;,tableName,array[i,0]);           int count3&#x3D;SQLHelper.CommandSQL(sql);           if (count3!&#x3D;-1)           Print(&quot;定义字段:&quot;+array[i,0]+&quot;成功；类型为：&quot;+array[i,1]);break;&#125;i++;           &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-ConnectAccess程序源码与程序结构"><a href="#4-ConnectAccess程序源码与程序结构" class="headerlink" title="4. ConnectAccess程序源码与程序结构"></a>4. ConnectAccess程序源码与程序结构</h2><h3 id="4-1-程序结构"><a href="#4-1-程序结构" class="headerlink" title="4.1 程序结构"></a>4.1 程序结构</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">│  ConnectAccess.sln│  └─ConnectAccess    │  app.config    │  ConnectAccess.csproj    │  MainForm.cs    │  MainForm.Designer.cs    │  MainForm.resx    │  Program.cs    │  SQLHelper.cs    │      ├─bin    │  └─Debug    │          ConnectAccess.exe    │          ConnectAccess.exe.config    │          ConnectAccess.pdb    │          ConnectAccess.vshost.exe    │          ConnectAccess.vshost.exe.config    │          ConnectAccess.vshost.exe.manifest    │              ├─obj    │  └─Debug    │      │  ConnectAccess.csproj.FileListAbsolute.txt    │      │  ConnectAccess.csprojResolveAssemblyReference.cache    │      │  ConnectAccess.exe    │      │  ConnectAccess.pdb    │      │  DesignTimeResolveAssemblyReferencesInput.cache    │      │      │      └─TempPE    └─Properties            AssemblyInfo.cs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-2-使用说明"><a href="#4-2-使用说明" class="headerlink" title="4.2 使用说明"></a>4.2 使用说明</h3><p>&emsp;&emsp;可以在配置文件<font color='red'>app.config</font>中增加需要改变的字段数据。</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>startup</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>supportedRuntime</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>v4.0<span class="token punctuation">"</span></span> <span class="token attr-name">sku</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>.NETFramework,Version=v4.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>startup</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appSettings</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>SQLConnString<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Provider=Microsoft.Jet.OleDb.4.0;Data Source=//DESKTOP-KM4H7JL//access//130431SXB.mdb<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>add</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>QXDM<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>131124<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appSettings</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-3-源码地址"><a href="#4-3-源码地址" class="headerlink" title="4.3 源码地址"></a>4.3 源码地址</h3><p><a href="https://gitee.com/mrwhitebare/daily-garbage-applet">传送门</a></p><h2 id="欢迎大家积极评论"><a href="#欢迎大家积极评论" class="headerlink" title="欢迎大家积极评论"></a>欢迎大家积极评论</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-using关键字的用法&quot;&gt;&lt;a href=&quot;#1-using关键字的用法&quot; class=&quot;headerlink&quot; title=&quot;1.using关键字的用法&quot;&gt;&lt;/a&gt;1.using关键字的用法&lt;/h2&gt;&lt;h3 id=&quot;1-1-引用命名空间&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    <category term="服务端编程" scheme="https://mrwhitebare.github.io/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%BC%96%E7%A8%8B/"/>
    
    
    <category term="C#" scheme="https://mrwhitebare.github.io/tags/C/"/>
    
    <category term="数据库" scheme="https://mrwhitebare.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="Access" scheme="https://mrwhitebare.github.io/tags/Access/"/>
    
  </entry>
  
  <entry>
    <title>对于使用hexo-prism-plugin插件代码无法渲染问题的解决方法</title>
    <link href="https://mrwhitebare.github.io/2020/091331943.html"/>
    <id>https://mrwhitebare.github.io/2020/091331943.html</id>
    <published>2020-09-12T16:00:00.000Z</published>
    <updated>2020-09-24T03:37:44.272Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-问题描述"><a href="#1-问题描述" class="headerlink" title="1.问题描述"></a>1.问题描述</h2><p>按照其他博主的对于hexo的个性化配置，我使用了代码高亮插件——prism-plugin，但是使用此插件却无法实现代码高亮的功能；而且对于代码行数也无法进行正确的渲染，大致情况如下。</p><p><img src="/medias/blogpic/line_error.png" alt="渲染错误"></p><h3 id="1-1-我的站点hexo配置情况"><a href="#1-1-我的站点hexo配置情况" class="headerlink" title="1.1 我的站点hexo配置情况"></a>1.1 我的站点hexo配置情况</h3><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">hexo</span><span class="token punctuation">:</span> 5.1.1<span class="token key atrule">hexo-cli</span><span class="token punctuation">:</span> 4.2.0<span class="token key atrule">os</span><span class="token punctuation">:</span> Windows_NT 10.0.18363 win32 x64<span class="token key atrule">node</span><span class="token punctuation">:</span> 12.16.1<span class="token key atrule">v8</span><span class="token punctuation">:</span> 7.8.279.23<span class="token punctuation">-</span>node.31<span class="token key atrule">uv</span><span class="token punctuation">:</span> 1.34.0<span class="token key atrule">zlib</span><span class="token punctuation">:</span> 1.2.11<span class="token key atrule">brotli</span><span class="token punctuation">:</span> 1.0.7<span class="token key atrule">ares</span><span class="token punctuation">:</span> 1.15.0<span class="token key atrule">modules</span><span class="token punctuation">:</span> <span class="token number">72</span><span class="token key atrule">nghttp2</span><span class="token punctuation">:</span> 1.40.0<span class="token key atrule">napi</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token key atrule">llhttp</span><span class="token punctuation">:</span> 2.0.4<span class="token key atrule">http_parser</span><span class="token punctuation">:</span> 2.9.3<span class="token key atrule">openssl</span><span class="token punctuation">:</span> 1.1.1d<span class="token key atrule">cldr</span><span class="token punctuation">:</span> <span class="token number">35.1</span><span class="token key atrule">icu</span><span class="token punctuation">:</span> <span class="token number">64.2</span><span class="token key atrule">tz</span><span class="token punctuation">:</span> 2019c<span class="token key atrule">unicode</span><span class="token punctuation">:</span> <span class="token number">12.1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="1-2-使用的安装方法"><a href="#1-2-使用的安装方法" class="headerlink" title="1.2 使用的安装方法"></a>1.2 使用的安装方法</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ cnpm <span class="token function">install</span> hexo-prism-plugin --save$ cnpm i -S hexo-prism-plugin //使用此写法也可以实现安装$ hexo clean <span class="token operator">&amp;&amp;</span> hexo generate <span class="token operator">&amp;&amp;</span> hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>hexo根目录下_config.yml文件下的配置情况：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">highlight</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span class="token key atrule">prism_plugin</span><span class="token punctuation">:</span>  <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token string">'preprocess'</span>    <span class="token comment"># realtime/preprocess</span>  <span class="token key atrule">theme</span><span class="token punctuation">:</span> <span class="token string">'default'</span>  <span class="token key atrule">line_number</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>   <span class="token comment"># default false</span>  <span class="token key atrule">custom_css</span><span class="token punctuation">:</span> <span class="token string">''</span>     <span class="token comment"># optional</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="1-3-hexo使用主题为matery"><a href="#1-3-hexo使用主题为matery" class="headerlink" title="1.3 hexo使用主题为matery"></a>1.3 hexo使用主题为matery</h3><p>hexo-themes-matery主题 <a href="https://github.com/blinkfox/hexo-theme-matery">https://github.com/blinkfox/hexo-theme-matery</a></p><p>尽管安装过程与配置情况与网上博客相同，但仍然无法实现代码高亮功能。希望情况和我一样的小伙伴可以耐心阅读下去😀。</p><h2 id="2-问题探索"><a href="#2-问题探索" class="headerlink" title="2.问题探索"></a>2.问题探索</h2><p>首先，我切换了hexo的主题为默认主题landscape，发现该主题下可以实现代码行数正确显示；但是仍然无法实现高亮显示，联想matery主题下代码行数显示错误——盲猜可能是主题适配存在缺陷。</p><p>然后，我转变了思路——寻找可以实现代码高亮的方式；找到了此篇博文——&gt;<a href="https://www.jianshu.com/p/f395d92a1110">https://www.jianshu.com/p/f395d92a1110</a></p><p>按照其思路实现了代码高亮功能😁</p><p><img src="/medias/blogpic/line_correct.png" alt="效果显示"></p><h2 id="3-问题解决"><a href="#3-问题解决" class="headerlink" title="3.问题解决"></a>3.问题解决</h2><h3 id="3-1-进入prismjs官网"><a href="#3-1-进入prismjs官网" class="headerlink" title="3.1 进入prismjs官网"></a>3.1 进入prismjs官网</h3><p>prismjs <a href="https://prismjs.com/download.html">https://prismjs.com/download.html</a></p><p>prismjs介绍：Prism是一种轻量级的，可扩展的语法突出显示工具，在构建时考虑了现代Web标准。</p><h3 id="3-2-选择主题、语言、其他插件"><a href="#3-2-选择主题、语言、其他插件" class="headerlink" title="3.2 选择主题、语言、其他插件"></a>3.2 选择主题、语言、其他插件</h3><p><img src="/medias/blogpic/primjs.png" alt="prismjs"></p><p>点击下载JS和CSS code即可</p><h3 id="3-3-文件放置位置"><a href="#3-3-文件放置位置" class="headerlink" title="3.3 文件放置位置"></a>3.3 文件放置位置</h3><blockquote><p>step1. 可以在themes\hexo-theme-matery\source\js下新建prism文件夹，用来存放js与css代码。</p></blockquote><blockquote><p>step2. 找到此文件hexo-theme-matery\layout_partial\head.ejs打开，在 head标签之前黏贴以下代码：</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/js/prism/prism.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>step3. 找到此文件hexo-theme-matery\layout_partial\footer.ejs打开，在link 标签最后部分黏贴以下代码：</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/js/prism/prism.js<span class="token punctuation">"</span></span> <span class="token attr-name">async</span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>step4. 记得在hexo的根目录_config.yml下设置enable: false</p></blockquote><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">highlight</span><span class="token punctuation">:</span>  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>step5. 重新生成博客文件，重启本地服务。</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo clean$ hexo generate$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>欢迎大家积极评论交流。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-问题描述&quot;&gt;&lt;a href=&quot;#1-问题描述&quot; class=&quot;headerlink&quot; title=&quot;1.问题描述&quot;&gt;&lt;/a&gt;1.问题描述&lt;/h2&gt;&lt;p&gt;按照其他博主的对于hexo的个性化配置，我使用了代码高亮插件——prism-plugin，但是使用此插件却无</summary>
      
    
    
    
    <category term="日常维护" scheme="https://mrwhitebare.github.io/categories/%E6%97%A5%E5%B8%B8%E7%BB%B4%E6%8A%A4/"/>
    
    
    <category term="hexo" scheme="https://mrwhitebare.github.io/tags/hexo/"/>
    
    <category term="prims-plugin" scheme="https://mrwhitebare.github.io/tags/prims-plugin/"/>
    
    <category term="matery" scheme="https://mrwhitebare.github.io/tags/matery/"/>
    
  </entry>
  
  <entry>
    <title>使用arcpy批量删除shp数据字段和添加字段</title>
    <link href="https://mrwhitebare.github.io/2020/0912976.html"/>
    <id>https://mrwhitebare.github.io/2020/0912976.html</id>
    <published>2020-09-11T16:00:00.000Z</published>
    <updated>2020-09-13T14:06:15.318Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ArcPy"><a href="#ArcPy" class="headerlink" title="ArcPy"></a>ArcPy</h2><h3 id="1-1-ArcPy介绍"><a href="#1-1-ArcPy介绍" class="headerlink" title="1.1 ArcPy介绍"></a>1.1 ArcPy介绍</h3><p>ArcPy 是一个以成功的 arcgisscripting 模块为基础并继承了 arcgisscripting 功能进而构建而成的站点包。目的是为以实用高效的方式通过 Python 执行地理数据分析、数据转换、数据管理和地图自动化创建基础。</p><p>该包提供了丰富纯正的 Python 体验，具有代码自动完成功能（输入关键字和点即可获得该关键字所支持的属性和方法的弹出列表；从中选择一个属性或方法即可将其插入），并针对每个函数、模块和类提供了参考文档。</p><p>在 Python 中使用 ArcPy 的另一个主要原因是，Python 是一种通用的编程语言。Python 是一种支持动态输入的解释型语言，适用于交互式操作以及为称为脚本的一次性程序快速制作原型，同时其具有编写大型应用程序的强大功能。用 ArcPy 编写的 ArcGIS 应用程序的优势在于，可以使用由来自多个不同领域的 GIS 专业人员和程序员组成的众多 Python 小群体开发的附加模块。</p><p><a href="https://desktop.arcgis.com/zh-cn/arcmap/10.3/analyze/arcpy/what-is-arcpy-.htm">推荐学习资料</a></p><h3 id="1-2-ArcPy基本词汇"><a href="#1-2-ArcPy基本词汇" class="headerlink" title="1.2 ArcPy基本词汇"></a>1.2 ArcPy基本词汇</h3><table><thead><tr><th align="center">术语</th><th align="left">定义</th></tr></thead><tbody><tr><td align="center">Python</td><td align="left">Python 是由 Guido van Rossum 在上世纪八十年代末构想并于 1991 年推出的一种开源编程语言。Python 得到了不断壮大的多元化用户群体的支持，具备简洁易读、语法清晰、支持动态定型等特点，并且具有大量标准库和第三方库。</td></tr><tr><td align="center">ArcPy</td><td align="left">ArcPy（通常称为 ArcPy 站点包）为用户提供了使用 Python 语言操作所有地理处理工具（包括扩展模块）的接口，并提供了多种有用的函数和类，以用于处理和查询 GIS 数据。使用 Python 和 ArcPy，可以开发出大量的用于处理地理数据的实用程序。</td></tr><tr><td align="center">ArcPy 模块</td><td align="left">模块为通常包含函数和类的 Python 文件。ArcPy 由一系列模块支持，包括<a href="https://pro.arcgis.com/zh-cn/pro-app/arcpy/data-access/what-is-the-data-access-module-.htm">数据访问模块</a> (arcpy.da)、<a href="https://pro.arcgis.com/zh-cn/pro-app/arcpy/mapping/introduction-to-arcpy-mp.htm">制图模块</a> (arcpy.mp)、<a href="https://pro.arcgis.com/zh-cn/pro-app/arcpy/spatial-analyst/what-is-the-spatial-analyst-module.htm">ArcGIS Spatial Analyst extension 模块</a> (arcpy.sa)、ArcGIS Image Analyst extension 模块以及 <a href="https://pro.arcgis.com/zh-cn/pro-app/arcpy/network-analyst/what-is-network-analyst-module.htm">ArcGIS Network Analyst extension 模块</a> (arcpy.na)。</td></tr><tr><td align="center">ArcPy 类</td><td align="left">类的作用类似于建筑设计蓝图。蓝图为如何创建事物提供了一个框架。类可用于创建对象，即通常所说的实例。ArcPy 类，如 SpatialReference 和 Extent 类，通常用作地理处理工具参数设置的快捷方式，否则的话，这些参数会使用更加复杂的字符串。</td></tr><tr><td align="center">ArcPy 函数</td><td align="left">函数是用于执行某项特定任务并能够纳入更大的程序的已定义功能。在 ArcPy 中，所有地理处理工具均以函数形式提供，但并非所有函数都是地理处理工具。除工具之外，ArcPy 还提供多种函数来更好地支持 Python 地理处理工作流。函数（通常称为方法）可用于列出某些数据集、检索数据集的属性、在将表添加到地理数据库之前验证表名称，或执行其他许多有用的脚本任务。</td></tr><tr><td align="center">独立 Python 脚本</td><td align="left">独立 Python 脚本是一种 .py 文件，可通过两种方式执行：通过操作系统提示符，或 Python 集成开发环境 (IDE)。</td></tr><tr><td align="center">Python 脚本工具</td><td align="left">Python 脚本工具是已添加到地理处理工具箱的 Python 脚本。添加为脚本工具后，便可以像使用其他地理处理工具一样使用此脚本工具 - 可以从工具对话框打开和执行、可以在 Python 窗口和 ModelBuilder 中使用，也可以从其他脚本和脚本工具中调用。</td></tr><tr><td align="center">Python 窗口</td><td align="left">通过 <strong>Python</strong> 窗口，用户可以快捷地在 ArcGIS 内部使用 Python，从而以交互方式运行地理处理工具和功能以及充分利用其他 Python 模块和库。此窗口还为您学习 Python 提供了一个途径。<strong>Python</strong> 窗口可用于执行单行 Python 代码，并会将由此生成的消息输出到窗口。借助此窗口，您可以对语法进行试验和处理短代码，并可以在大型脚本范围之外对您的想法进行检验。</td></tr><tr><td align="center">Python 工具箱</td><td align="left">Python 工具箱是完全使用 Python 语言创建的地理处理工具箱。Python 工具箱及其所包含工具的外观、操作和运行方式与任何以其他方式创建的工具箱和工具类似。Python 工具箱是一个具有 .pyt 扩展名的 Python 文件，用于定义工具箱以及一个或多个工具。</td></tr></tbody></table><h2 id="ArcGIS介绍及代码分析"><a href="#ArcGIS介绍及代码分析" class="headerlink" title="ArcGIS介绍及代码分析"></a>ArcGIS介绍及代码分析</h2><h3 id="2-1-ArcGIS介绍"><a href="#2-1-ArcGIS介绍" class="headerlink" title="2.1 ArcGIS介绍"></a>2.1 ArcGIS介绍</h3><p>ArcGIS产品线为用户提供一个可伸缩的，全面的GIS平台。ArcObjects包含了许多的可编程组件，从细粒度的对象（例如单个的几何对象）到粗粒度的对象（例如与现有ArcMap文档交互的地图对象）涉及面极广，这些对象为开发者集成了全面的GIS功能。</p><p><a href="https://www.esri.com/zh-cn/arcgis/about-arcgis/overview">ArcGIS官网</a></p><h3 id="2-2-主要涉及工具与方法"><a href="#2-2-主要涉及工具与方法" class="headerlink" title="2.2 主要涉及工具与方法"></a>2.2 主要涉及工具与方法</h3><p>本程序主要使用如下工具</p><table><thead><tr><th align="left">工具名称</th><th align="center">方法</th></tr></thead><tbody><tr><td align="left">DeleteFileds【删除字段】</td><td align="center">arcpy.DeleteField_management(input_data,delete_fields)</td></tr><tr><td align="left">AddFileds【添加字段】</td><td align="center">arcpy.AddField_management(input_data,field_Name,fields_Type,field_Length)方法介绍：[‘输入数据’,’字段名称’,’字段类型’,’字段长度’]以上为TEXT字段输入形式。arcpy.AddField_management(input_data,field_Name,fields_Type,field_Precision,field_Scale)以上为”FLOAT“或”DOUBLE“输入形式，新的参数表示 [数据精度,小数点后位数]</td></tr><tr><td align="left">DefineProjection【定义投影】</td><td align="center">arcpy.DefineProjection_management(in_data,project)project参数为投影坐标系统</td></tr></tbody></table><h3 id="2-3-设计思路"><a href="#2-3-设计思路" class="headerlink" title="2.3 设计思路"></a>2.3 设计思路</h3><p>首先调用制图模块arcpy.mapping读取当前地图文档，然后将当前地图文档的Layers图层转化为Python List；我们要筛选不符合要求的字段，及要求建立的字段创建列表，通过循环分别调用工具即可实现批量生成标准字段的工作任务。</p><h3 id="2-4-代码展示"><a href="#2-4-代码展示" class="headerlink" title="2.4 代码展示"></a>2.4 代码展示</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#生成标准国标字段 Version1.0 CopyRight by Mr Heisenberg</span><span class="token keyword">import</span> arcpy<span class="token comment">#打开地图文档</span>mymxd <span class="token operator">=</span>arcpy<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span>MapDocument<span class="token punctuation">(</span><span class="token string">"current"</span><span class="token punctuation">)</span>ary <span class="token operator">=</span>arcpy<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span>ListLayers<span class="token punctuation">(</span>mymxd<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''坐标系统解析地理坐标系统：CGCS2000国家质心坐标系统椭球体参数：长半轴a：6378137.0，扁率α：1/298.257222101投影坐标系统：Gauss_Kruger高斯克里格3°带投影坐标中央经线：117°起始纬线：0°单位：m'''</span>cgcs2000_39<span class="token operator">=</span>"PROJCS<span class="token punctuation">[</span><span class="token string">'CGCS2000_3_Degree_GK_Zone_39'</span><span class="token punctuation">,</span>\GEOGCS<span class="token punctuation">[</span><span class="token string">'GCS_China_Geodetic_Coordinate_System_2000'</span><span class="token punctuation">,</span>\DATUM<span class="token punctuation">[</span><span class="token string">'D_China_2000'</span><span class="token punctuation">,</span>SPHEROID<span class="token punctuation">[</span><span class="token string">'CGCS2000'</span><span class="token punctuation">,</span><span class="token number">6378137.0</span><span class="token punctuation">,</span><span class="token number">298.257222101</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\PRIMEM<span class="token punctuation">[</span><span class="token string">'Greenwich'</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>UNIT<span class="token punctuation">[</span><span class="token string">'Degree'</span><span class="token punctuation">,</span><span class="token number">0.0174532925199433</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\PROJECTION<span class="token punctuation">[</span><span class="token string">'Gauss_Kruger'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>PARAMETER<span class="token punctuation">[</span><span class="token string">'False_Easting'</span><span class="token punctuation">,</span><span class="token number">39500000.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\PARAMETER<span class="token punctuation">[</span><span class="token string">'False_Northing'</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>PARAMETER<span class="token punctuation">[</span><span class="token string">'Central_Meridian'</span><span class="token punctuation">,</span><span class="token number">117.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\PARAMETER<span class="token punctuation">[</span><span class="token string">'Scale_Factor'</span><span class="token punctuation">,</span><span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>PARAMETER<span class="token punctuation">[</span><span class="token string">'Latitude_Of_Origin'</span><span class="token punctuation">,</span><span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>UNIT<span class="token punctuation">[</span><span class="token string">'Meter'</span><span class="token punctuation">,</span><span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>"<span class="token comment">#删除字段列表</span>delete_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"YBZDDM"</span><span class="token punctuation">,</span><span class="token string">"QSXZ"</span><span class="token punctuation">,</span><span class="token string">"ZDSYQLX"</span><span class="token punctuation">,</span><span class="token string">"PZMJ"</span><span class="token punctuation">,</span><span class="token string">"TDJB"</span><span class="token punctuation">,</span><span class="token string">"SBDJ"</span><span class="token punctuation">,</span><span class="token string">"QDJG"</span><span class="token punctuation">,</span>\<span class="token string">"SFGY"</span><span class="token punctuation">,</span><span class="token string">"BLC"</span><span class="token punctuation">,</span><span class="token string">"PZYT"</span><span class="token punctuation">,</span><span class="token string">"SJYT"</span><span class="token punctuation">,</span><span class="token string">"QLSLQK"</span><span class="token punctuation">,</span><span class="token string">"GMJJHYFLDM"</span><span class="token punctuation">,</span><span class="token string">"JZZDMJ"</span><span class="token punctuation">,</span><span class="token string">"JZZMJ"</span><span class="token punctuation">,</span><span class="token string">"SYQSRQ"</span><span class="token punctuation">,</span>\<span class="token string">"SYQX"</span><span class="token punctuation">,</span><span class="token string">"SYZZRQ"</span><span class="token punctuation">,</span><span class="token string">"QTSM"</span><span class="token punctuation">,</span><span class="token string">"QLXZ"</span><span class="token punctuation">]</span><span class="token comment">#添加字段列表属性</span>fields<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"ZL"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"ZDMJ"</span><span class="token punctuation">,</span><span class="token string">"FLOAT"</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"MJDW"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"DJ"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\<span class="token punctuation">[</span><span class="token string">"JG"</span><span class="token punctuation">,</span><span class="token string">"FLOAT"</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"YT"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"ZDT"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"QLSDFS"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\        <span class="token punctuation">[</span><span class="token string">"RJL"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"JZXG"</span><span class="token punctuation">,</span><span class="token string">"FLOAT"</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"ZDSZD"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"ZDSZN"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\<span class="token punctuation">[</span><span class="token string">"ZDSZX"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"ZDSZB"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"DAH"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">254</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"BZ"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">254</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\<span class="token punctuation">[</span><span class="token string">"TFH"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"DJH"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"ZT"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"YTMC"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">254</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\<span class="token punctuation">[</span><span class="token string">"QXDM"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"QLXZ"</span><span class="token punctuation">,</span><span class="token string">"TEXT"</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#给特殊字段赋值</span>special_fields<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"ZDBZ"</span><span class="token punctuation">,</span><span class="token string">"ZDDZ"</span><span class="token punctuation">,</span><span class="token string">"ZDNZ"</span><span class="token punctuation">,</span><span class="token string">"ZDXZ"</span><span class="token punctuation">,</span><span class="token string">"SZTFH"</span><span class="token punctuation">,</span><span class="token string">"JZRJL"</span><span class="token punctuation">,</span><span class="token string">"SCMJ"</span><span class="token punctuation">,</span><span class="token string">"TDZL"</span><span class="token punctuation">]</span><span class="token comment">#固定字段</span>fixed_fields<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"QLLX"</span><span class="token punctuation">,</span><span class="token string">"5"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"QLXZ"</span><span class="token punctuation">,</span><span class="token string">"200"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"QLSDFS"</span><span class="token punctuation">,</span><span class="token string">"2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"MJDW"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"YT"</span><span class="token punctuation">,</span><span class="token string">"072"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"ZT"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\<span class="token punctuation">[</span><span class="token string">"YTMC"</span><span class="token punctuation">,</span><span class="token string">"农村宅基地"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"QXDM"</span><span class="token punctuation">,</span><span class="token string">"131124"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token comment">#新生成字段</span>New_fields<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"ZDSZB"</span><span class="token punctuation">,</span><span class="token string">"ZDSZD"</span><span class="token punctuation">,</span><span class="token string">"ZDSZN"</span><span class="token punctuation">,</span><span class="token string">"ZDSZX"</span><span class="token punctuation">,</span><span class="token string">"TFH"</span><span class="token punctuation">,</span><span class="token string">"RJL"</span><span class="token punctuation">,</span><span class="token string">"ZDMJ"</span><span class="token punctuation">,</span><span class="token string">"ZL"</span><span class="token punctuation">]</span><span class="token comment">#生成删除集</span>delete_txt<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> delete <span class="token keyword">in</span> delete_list<span class="token punctuation">:</span>delete_txt<span class="token operator">+=</span>delete<span class="token operator">+</span><span class="token string">";"</span><span class="token keyword">for</span> lyr <span class="token keyword">in</span> ary<span class="token punctuation">:</span>in_table<span class="token operator">=</span>lyr<span class="token punctuation">.</span>dataSource<span class="token keyword">if</span> in_table<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">".shp"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>arcpy<span class="token punctuation">.</span>DeleteField_management<span class="token punctuation">(</span>in_table<span class="token punctuation">,</span>delete_txt<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"多余字段删除完成！"</span><span class="token punctuation">)</span><span class="token keyword">for</span> count <span class="token keyword">in</span> fields<span class="token punctuation">:</span><span class="token keyword">if</span> count<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"TEXT"</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"名称:&#123;0&#125;———— 类形:&#123;1&#125;———— 长度:&#123;2&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>count<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>arcpy<span class="token punctuation">.</span>AddField_management<span class="token punctuation">(</span>in_table<span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>field_length<span class="token operator">=</span>count<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"名称:&#123;0&#125;———— 类形:&#123;1&#125;———— 精度:&#123;2&#125;———— 小数点位数：&#123;3&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>count<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>arcpy<span class="token punctuation">.</span>AddField_management<span class="token punctuation">(</span>in_table<span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>count<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"创建字段完成！"</span><span class="token punctuation">)</span><span class="token keyword">for</span> field <span class="token keyword">in</span> fixed_fields<span class="token punctuation">:</span>field_<span class="token operator">=</span><span class="token string">"\""</span><span class="token operator">+</span>field<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"\""</span>arcpy<span class="token punctuation">.</span>CalculateField_management<span class="token punctuation">(</span>in_table<span class="token punctuation">,</span>field<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>field_<span class="token punctuation">,</span> <span class="token string">"VB"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"赋予字段固定值完成！"</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>special_fields<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>field<span class="token operator">=</span><span class="token string">"["</span><span class="token operator">+</span>special_fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"]"</span>arcpy<span class="token punctuation">.</span>CalculateField_management<span class="token punctuation">(</span>in_table<span class="token punctuation">,</span>New_fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>field<span class="token punctuation">,</span><span class="token string">"VB"</span><span class="token punctuation">)</span>arcpy<span class="token punctuation">.</span>DeleteField_management<span class="token punctuation">(</span>in_table<span class="token punctuation">,</span>special_fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据交换完成！"</span><span class="token punctuation">)</span>arcpy<span class="token punctuation">.</span>DefineProjection_management<span class="token punctuation">(</span>in_table<span class="token punctuation">,</span>cgcs2000_39<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"定义国家2000坐标系统完成！"</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="token builtin">next</span><span class="token keyword">del</span> mymxdarcpy<span class="token punctuation">.</span>RefreshActiveView<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"------标准字段完成------"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>欢迎大家积极评论。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ArcPy&quot;&gt;&lt;a href=&quot;#ArcPy&quot; class=&quot;headerlink&quot; title=&quot;ArcPy&quot;&gt;&lt;/a&gt;ArcPy&lt;/h2&gt;&lt;h3 id=&quot;1-1-ArcPy介绍&quot;&gt;&lt;a href=&quot;#1-1-ArcPy介绍&quot; class=&quot;headerlink</summary>
      
    
    
    
    <category term="GIS" scheme="https://mrwhitebare.github.io/categories/GIS/"/>
    
    
    <category term="Python" scheme="https://mrwhitebare.github.io/tags/Python/"/>
    
    <category term="ArcGIS" scheme="https://mrwhitebare.github.io/tags/ArcGIS/"/>
    
    <category term="ArcPY" scheme="https://mrwhitebare.github.io/tags/ArcPY/"/>
    
  </entry>
  
  <entry>
    <title>解决大文件上传失败git命令失效问题</title>
    <link href="https://mrwhitebare.github.io/2020/091126490.html"/>
    <id>https://mrwhitebare.github.io/2020/091126490.html</id>
    <published>2020-09-10T16:00:00.000Z</published>
    <updated>2020-09-18T02:26:53.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-尝试删除视频"><a href="#1-尝试删除视频" class="headerlink" title="1.尝试删除视频"></a>1.尝试删除视频</h2><p>以我以前的经验而言，如果删除文件夹原有视频即可，但是仍然报错无法上传；后来找到原因——git commit 命令bug。<br><img src="https://ztygcs.github.io/images/tech/2019/11/large_file.png" alt="此图片为天涯共此时文章图片"></p><h2 id="2-尝试搜索错误"><a href="#2-尝试搜索错误" class="headerlink" title="2.尝试搜索错误"></a>2.尝试搜索错误</h2><p>上网看了天涯共此时<a href="https://ztygcs.github.io/">https://ztygcs.github.io/</a><br>该为博主对于该问题的解决方案。</p><h3 id="2-1查找hexokinase根目录下-deploy-git文件"><a href="#2-1查找hexokinase根目录下-deploy-git文件" class="headerlink" title="2.1查找hexokinase根目录下.deploy_git文件"></a>2.1查找hexokinase根目录下.deploy_git文件</h3><p>运行一下命令,查找运行日志</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-2找到自己出错误前的提交命令commit"><a href="#2-2找到自己出错误前的提交命令commit" class="headerlink" title="2.2找到自己出错误前的提交命令commit"></a>2.2找到自己出错误前的提交命令commit</h3><p><img src="/medias/blogpic/commit.png" alt="img"><br>找到之后运行以下代码恢复提交命令之前。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> reset yourcommit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-3重新使用提交命令"><a href="#2-3重新使用提交命令" class="headerlink" title="2.3重新使用提交命令"></a>2.3重新使用提交命令</h3><p>提示，在再次使用$ source up.sh 命令时，请删除原有的大文件夹；否则可能再次出现此问题。<br>成功解决问题，感谢天涯共此时大佬！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-尝试删除视频&quot;&gt;&lt;a href=&quot;#1-尝试删除视频&quot; class=&quot;headerlink&quot; title=&quot;1.尝试删除视频&quot;&gt;&lt;/a&gt;1.尝试删除视频&lt;/h2&gt;&lt;p&gt;以我以前的经验而言，如果删除文件夹原有视频即可，但是仍然报错无法上传；后来找到原因——git</summary>
      
    
    
    
    <category term="日常维护" scheme="https://mrwhitebare.github.io/categories/%E6%97%A5%E5%B8%B8%E7%BB%B4%E6%8A%A4/"/>
    
    
    <category term="hexo" scheme="https://mrwhitebare.github.io/tags/hexo/"/>
    
    <category term="matery" scheme="https://mrwhitebare.github.io/tags/matery/"/>
    
    <category term="day_error_log" scheme="https://mrwhitebare.github.io/tags/day-error-log/"/>
    
  </entry>
  
  <entry>
    <title>我的爷爷</title>
    <link href="https://mrwhitebare.github.io/2020/091016058.html"/>
    <id>https://mrwhitebare.github.io/2020/091016058.html</id>
    <published>2020-09-09T16:00:00.000Z</published>
    <updated>2020-09-16T12:27:18.288Z</updated>
    
    <content type="html"><![CDATA[<font face="华文行楷"><h2 id="只要平凡"><a href="#只要平凡" class="headerlink" title="只要平凡"></a><center><font size=8><a href="https://y.qq.com/portal/player.html">只要平凡</a><font></center></h2><p><img src="https://hiphotos.baidu.com/feed/pic/item/d52a2834349b033b7d2febbf18ce36d3d539bd2b.jpg"></p><center><font color="#FF5722"><h3 id="也许很远或是昨天"><a href="#也许很远或是昨天" class="headerlink" title="也许很远或是昨天"></a>也许很远或是昨天</h3><h3 id="在这里或在对岸"><a href="#在这里或在对岸" class="headerlink" title="在这里或在对岸"></a>在这里或在对岸</h3><h3 id="长路辗转离合悲欢"><a href="#长路辗转离合悲欢" class="headerlink" title="长路辗转离合悲欢"></a>长路辗转离合悲欢</h3><h3 id="人聚又对岸"><a href="#人聚又对岸" class="headerlink" title="人聚又对岸"></a>人聚又对岸</h3><h3 id="放过对错才知答案"><a href="#放过对错才知答案" class="headerlink" title="放过对错才知答案"></a>放过对错才知答案</h3><h3 id="活着的勇敢"><a href="#活着的勇敢" class="headerlink" title="活着的勇敢"></a>活着的勇敢</h3><h3 id="没有神的光环"><a href="#没有神的光环" class="headerlink" title="没有神的光环"></a>没有神的光环</h3><h3 id="你我生而平凡"><a href="#你我生而平凡" class="headerlink" title="你我生而平凡"></a>你我生而平凡</h3><h3 id="在心碎中认清遗憾"><a href="#在心碎中认清遗憾" class="headerlink" title="在心碎中认清遗憾"></a>在心碎中认清遗憾</h3><h3 id="生命漫长也短暂"><a href="#生命漫长也短暂" class="headerlink" title="生命漫长也短暂"></a>生命漫长也短暂</h3><h3 id="跳动心脏长出藤蔓"><a href="#跳动心脏长出藤蔓" class="headerlink" title="跳动心脏长出藤蔓"></a>跳动心脏长出藤蔓</h3><h3 id="愿为险而战"><a href="#愿为险而战" class="headerlink" title="愿为险而战"></a>愿为险而战</h3><h3 id="跌入灰暗坠入深渊"><a href="#跌入灰暗坠入深渊" class="headerlink" title="跌入灰暗坠入深渊"></a>跌入灰暗坠入深渊</h3><h3 id="沾满泥土的脸"><a href="#沾满泥土的脸" class="headerlink" title="沾满泥土的脸"></a>沾满泥土的脸</h3><h3 id="没有神的光环-1"><a href="#没有神的光环-1" class="headerlink" title="没有神的光环"></a>没有神的光环</h3><h3 id="握紧手中的平凡"><a href="#握紧手中的平凡" class="headerlink" title="握紧手中的平凡"></a>握紧手中的平凡</h3><h3 id="此心此生无憾"><a href="#此心此生无憾" class="headerlink" title="此心此生无憾"></a>此心此生无憾</h3><h3 id="生命的火已点燃"><a href="#生命的火已点燃" class="headerlink" title="生命的火已点燃"></a>生命的火已点燃</h3><h3 id="有一天也许会走远"><a href="#有一天也许会走远" class="headerlink" title="有一天也许会走远"></a>有一天也许会走远</h3><h3 id="也许还能再相见"><a href="#也许还能再相见" class="headerlink" title="也许还能再相见"></a>也许还能再相见</h3><h3 id="无论在人群在天边"><a href="#无论在人群在天边" class="headerlink" title="无论在人群在天边"></a>无论在人群在天边</h3><h3 id="让我在看清你的脸"><a href="#让我在看清你的脸" class="headerlink" title="让我在看清你的脸"></a>让我在看清你的脸</h3><h3 id="任泪水铺满了双眼"><a href="#任泪水铺满了双眼" class="headerlink" title="任泪水铺满了双眼"></a>任泪水铺满了双眼</h3><h3 id="虽无言泪满脸"><a href="#虽无言泪满脸" class="headerlink" title="虽无言泪满脸"></a>虽无言泪满脸</h3><h3 id="不要神的光环"><a href="#不要神的光环" class="headerlink" title="不要神的光环"></a>不要神的光环</h3><h3 id="只要你的平凡"><a href="#只要你的平凡" class="headerlink" title="只要你的平凡"></a>只要你的平凡</h3><p><img src="https://p2.pstatp.com/large/2c230001cfa96e9561ec"></p><h3 id="在心碎中认清遗憾-1"><a href="#在心碎中认清遗憾-1" class="headerlink" title="在心碎中认清遗憾"></a>在心碎中认清遗憾</h3><h3 id="生命漫长也短暂-1"><a href="#生命漫长也短暂-1" class="headerlink" title="生命漫长也短暂"></a>生命漫长也短暂</h3><h3 id="跳动心脏长出藤蔓-1"><a href="#跳动心脏长出藤蔓-1" class="headerlink" title="跳动心脏长出藤蔓"></a>跳动心脏长出藤蔓</h3><h3 id="愿为险而站"><a href="#愿为险而站" class="headerlink" title="愿为险而站"></a>愿为险而站</h3><h3 id="跌入灰暗坠入深渊-1"><a href="#跌入灰暗坠入深渊-1" class="headerlink" title="跌入灰暗坠入深渊"></a>跌入灰暗坠入深渊</h3><h3 id="沾满泥土的脸-1"><a href="#沾满泥土的脸-1" class="headerlink" title="沾满泥土的脸"></a>沾满泥土的脸</h3><h3 id="没有神的光环-2"><a href="#没有神的光环-2" class="headerlink" title="没有神的光环"></a>没有神的光环</h3><h3 id="紧握手中的平凡"><a href="#紧握手中的平凡" class="headerlink" title="紧握手中的平凡"></a>紧握手中的平凡</h3><h3 id="有一天也许会走远-1"><a href="#有一天也许会走远-1" class="headerlink" title="有一天也许会走远"></a>有一天也许会走远</h3><h3 id="也许还能再相见-1"><a href="#也许还能再相见-1" class="headerlink" title="也许还能再相见"></a>也许还能再相见</h3><h3 id="无论在人群在天边-1"><a href="#无论在人群在天边-1" class="headerlink" title="无论在人群在天边"></a>无论在人群在天边</h3><h3 id="让我再看清你的脸"><a href="#让我再看清你的脸" class="headerlink" title="让我再看清你的脸"></a>让我再看清你的脸</h3><h3 id="任泪水铺满双眼"><a href="#任泪水铺满双眼" class="headerlink" title="任泪水铺满双眼"></a>任泪水铺满双眼</h3><h3 id="虽无言泪满面"><a href="#虽无言泪满面" class="headerlink" title="虽无言泪满面"></a>虽无言泪满面</h3><h3 id="不要神的光环-1"><a href="#不要神的光环-1" class="headerlink" title="不要神的光环"></a>不要神的光环</h3><h3 id="只要你的平凡-1"><a href="#只要你的平凡-1" class="headerlink" title="只要你的平凡"></a>只要你的平凡</h3><h3 id="此心此生无憾-1"><a href="#此心此生无憾-1" class="headerlink" title="此心此生无憾"></a>此心此生无憾</h3><h3 id="生命的火已点燃-1"><a href="#生命的火已点燃-1" class="headerlink" title="生命的火已点燃"></a>生命的火已点燃</h3><p></font><br></center></p><blockquote><h2 id="我的爷爷"><a href="#我的爷爷" class="headerlink" title="我的爷爷"></a><center>我的爷爷</center></h2><font color=#000000 size=5>&emsp;&emsp;时间过得太快，让人不知所措，只好望着那些曾经的美好发呆，努力回忆着以前的日子，但记忆的容量是有限的，再怎么回忆，也只剩下了一丝痕迹。你的悄然离去，让我感到茫然，怎么才能把你留住？</font><br><font color=#000000 size=5 >&emsp;&emsp;韶光易逝，转眼已是初秋；您离开我们已5月有余，您曾经工作的地点——大湾村，没想到最后成了您的长眠之地。以前我一直以为死亡是一个飘渺和不可琢磨的旅者，但是我们谁都没想到，突然它就带走了您。</font><br><font color=#000000 size=5 >&emsp;&emsp;从十几岁起作为长兄的您就扛起了整个家庭的重担——瓦工、木工、水电工您几乎都做过了，几十年的时间一直不停在各地工作；您的足迹几乎踏遍了整个城市。如果有来世，希望您不要再生活的这么累；如果有来世，希望您不要再受病痛的折磨；如果有来世，希望还能做您的孙子……</font><br><font color=#000000 size=5 >&emsp;&emsp;从我记事起，就有这么一个和蔼可亲的爷爷。带着我回家，我哭闹了一整晚，就抱着我一整晚；妈妈生病了，也瞒着我，给我买我想要的小剪刀；我不听话，虚度光阴时，总是砥砺我；在我因为任性不想坐车回家时，骑着银色的电动车去城市接我；每个星期五的下午，总会在校门口等着我；自己因为疾病那么痛苦，还关心着我……</font><br><font color=#000000 size=5>&emsp;&emsp;海畔尖山似剑芒，秋来处处割愁肠。若为化得身千亿，散上峰头望故乡。身处异乡的我，如今愁绪万千；过去的我总是知道，我的身后一直有您和奶奶的支持，虽然远在千里之外 ，也不曾觉得时间竟如此的煎熬；如今您却离我们大家而去了。我一直安慰奶奶和妈妈：“生命开始的时候，就已经开始衰败了”，但是其实我也接受不了您离去的事实。但是，看着您的身体日渐消瘦——最后日子里，您的身体仿佛只剩下了骨头和皮，没有丝毫的血肉了；我真的特别痛心，我情愿我来替您受这份罪。我们大家都想不明白，这么好的一个人，怎么就得了这么受罪、这么折磨人的病。</font><br><font color=#000000 size=5>&emsp;&emsp;您希望家里那所破旧院子重新翻新、您希望孤独的奶奶可以安享晚年、您希望自己的子孙家庭幸福，和和美美……我知道您有太多的不舍，您有太多的牵挂，您有太多的遗憾。你放心吧，我会好好照顾奶奶的，我也会努力做一个有用的人，会努力和家人们一起努力过好幸福的生活。</font><br><font color=#000000 size=5 >&emsp;&emsp;您这辈子，奔波了一生；但是从未踏出过省外，就让那条红布作为我们之间的连接与纽带；让我当您的眼睛，让我做您的双脚带着您去看看甘肃之外的生活；看看异乡的风俗和异乡的人与文化……</font><br><p><img src="/medias/blogpic/We_are_family.png" alt="送给您的全家福"></p></blockquote><center><h3 id="有一天也许会走远-2"><a href="#有一天也许会走远-2" class="headerlink" title="有一天也许会走远"></a>有一天也许会走远</h3><h3 id="也许还能再相见-2"><a href="#也许还能再相见-2" class="headerlink" title="也许还能再相见"></a>也许还能再相见</h3><h3 id="无论在人群在天边-2"><a href="#无论在人群在天边-2" class="headerlink" title="无论在人群在天边"></a>无论在人群在天边</h3><h3 id="让我再看清你的脸-1"><a href="#让我再看清你的脸-1" class="headerlink" title="让我再看清你的脸"></a>让我再看清你的脸</h3><h3 id="任泪水铺满了双眼-1"><a href="#任泪水铺满了双眼-1" class="headerlink" title="任泪水铺满了双眼"></a>任泪水铺满了双眼</h3><h3 id="虽无言泪满面-1"><a href="#虽无言泪满面-1" class="headerlink" title="虽无言泪满面"></a>虽无言泪满面</h3><h3 id="不要神的光环-2"><a href="#不要神的光环-2" class="headerlink" title="不要神的光环"></a>不要神的光环</h3><h3 id="只要你的平凡-2"><a href="#只要你的平凡-2" class="headerlink" title="只要你的平凡"></a>只要你的平凡</h3><h3 id="在心碎中认清遗憾-2"><a href="#在心碎中认清遗憾-2" class="headerlink" title="在心碎中认清遗憾"></a>在心碎中认清遗憾</h3><h3 id="生命漫长也短暂-2"><a href="#生命漫长也短暂-2" class="headerlink" title="生命漫长也短暂"></a>生命漫长也短暂</h3><h3 id="跳动心脏长出藤蔓-2"><a href="#跳动心脏长出藤蔓-2" class="headerlink" title="跳动心脏长出藤蔓"></a>跳动心脏长出藤蔓</h3><h3 id="愿为险而战-1"><a href="#愿为险而战-1" class="headerlink" title="愿为险而战"></a>愿为险而战</h3><h3 id="跌入灰暗坠入深渊-2"><a href="#跌入灰暗坠入深渊-2" class="headerlink" title="跌入灰暗坠入深渊"></a>跌入灰暗坠入深渊</h3><h3 id="沾满泥土的脸-2"><a href="#沾满泥土的脸-2" class="headerlink" title="沾满泥土的脸"></a>沾满泥土的脸</h3><h3 id="没有神的光环-3"><a href="#没有神的光环-3" class="headerlink" title="没有神的光环"></a>没有神的光环</h3><h3 id="握紧手中的平凡-1"><a href="#握紧手中的平凡-1" class="headerlink" title="握紧手中的平凡 "></a>握紧手中的平凡 </h3></center><p align="right"><font size=5 >记于——2020/9/16 <font></p></font>]]></content>
    
    
      
      
    <summary type="html">&lt;font face=&quot;华文行楷&quot;&gt;

&lt;h2 id=&quot;只要平凡&quot;&gt;&lt;a href=&quot;#只要平凡&quot; class=&quot;headerlink&quot; title=&quot;只要平凡&quot;&gt;&lt;/a&gt;&lt;center&gt;&lt;font size=8&gt;&lt;a href=&quot;https://y.qq.com/portal/</summary>
      
    
    
    
    <category term="亲情" scheme="https://mrwhitebare.github.io/categories/%E4%BA%B2%E6%83%85/"/>
    
    
    <category term="怀念" scheme="https://mrwhitebare.github.io/tags/%E6%80%80%E5%BF%B5/"/>
    
    <category term="回忆" scheme="https://mrwhitebare.github.io/tags/%E5%9B%9E%E5%BF%86/"/>
    
    <category term="反思" scheme="https://mrwhitebare.github.io/tags/%E5%8F%8D%E6%80%9D/"/>
    
  </entry>
  
</feed>
